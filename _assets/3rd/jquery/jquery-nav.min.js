(function($,c,a,e){var b=function(g,f){this.elem=g;this.$elem=$(g);this.options=f;this.metadata=this.$elem.data("plugin-options");this.$win=$(c);this.sections={};this.didScroll=false;this.$doc=$(a);this.docHeight=this.$doc.height()};b.prototype={defaults:{navItems:"a",currentClass:"current-menu-item",changeHash:false,easing:"swing",filter:"",scrollSpeed:750,scrollThreshold:0.5,begin:false,end:false,scrollChange:false},init:function(){this.config=$.extend({},this.defaults,this.options,this.metadata);this.$nav=this.$elem.find(this.config.navItems);if(this.config.filter!==""){this.$nav=this.$nav.filter(this.config.filter)}this.$nav.on("click.onePageNav",$.proxy(this.handleClick,this));this.getPositions();this.bindInterval();this.$win.on("resize.onePageNav",$.proxy(this.getPositions,this));return this},adjustNav:function(f,g){f.$elem.find("."+f.config.currentClass).removeClass(f.config.currentClass);g.addClass(f.config.currentClass)},bindInterval:function(){var g=this;var f;g.$win.on("scroll.onePageNav",function(){g.didScroll=true});g.t=setInterval(function(){f=g.$doc.height();if(g.didScroll){g.didScroll=false;g.scrollChange()}if(f!==g.docHeight){g.docHeight=f;g.getPositions()}},250)},getHash:function(f){return f.attr("href").split("#")[1]},getPositions:function(){var h=this;var i;var g;var f;h.$nav.each(function(){i=h.getHash($(this));f=$("#"+i);if(f.length){g=f.offset().top;h.sections[i]=Math.round(g)}})},getSection:function(i){var f=null;var h=Math.round(this.$win.height()*this.config.scrollThreshold);for(var g in this.sections){if((this.sections[g]-h)<i){f=g}}return f},getPathname:function(g){var f=g.get(0).href;var h=f.substring(0,f.indexOf("#"));return h},handleClick:function(l){var g=this;var f=$(l.currentTarget);var k=f.parent();var j=g.getHash(f);var i=g.getPathname(f);if(j!==e&&i.indexOf(c.location.pathname)>=0){var h="#"+j;if(!k.hasClass(g.config.currentClass)){if(g.config.begin){g.config.begin()}g.adjustNav(g,k);g.unbindInterval();g.scrollTo(h,function(){if(g.config.changeHash){c.location.hash=h}g.bindInterval();if(g.config.end){g.config.end()}})}l.preventDefault()}},scrollChange:function(){var h=this.$win.scrollTop();var f=this.getSection(h);var g;if(f!==null){g=this.$elem.find('a[href$="#'+f+'"]').parent();if(!g.hasClass(this.config.currentClass)){this.adjustNav(this,g);if(this.config.scrollChange){this.config.scrollChange(g)}}}},scrollTo:function(g,i){var f=$(g);if(f.length>0){var h=$(g).offset().top;$("html, body").animate({scrollTop:h},this.config.scrollSpeed,this.config.easing,i)}},unbindInterval:function(){clearInterval(this.t);this.$win.unbind("scroll.onePageNav")}};b.defaults=b.prototype.defaults;$.fn.onePageNav=function(f){return this.each(function(){new b(this,f).init()})}})(jQuery,window,document);